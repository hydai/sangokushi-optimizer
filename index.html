<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三國志城建優化器</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- 側邊欄遮罩 -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- 側邊欄 -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2>建築管理</h2>
            <button id="sidebarClose" class="sidebar-close">&times;</button>
        </div>

        <div class="sidebar-section">
            <button id="loadDefaultsBtn" class="btn btn-secondary btn-block">載入預設建築</button>
        </div>

        <div class="sidebar-section">
            <h3 class="sidebar-section-title">新增建築</h3>
            <div class="sidebar-hint">點擊建築名稱選擇變體</div>
            <div id="buildingSelector" class="building-selector"></div>
        </div>

        <div class="sidebar-section sidebar-buildings-section">
            <h3 class="sidebar-section-title">我的建築 (<span id="userBuildingCount">0</span>)</h3>
            <div id="userBuildingsList" class="user-buildings-list"></div>
        </div>

        <div class="sidebar-section sidebar-footer">
            <h3 class="sidebar-section-title">資料管理</h3>
            <div class="export-import-buttons">
                <button id="exportBtn" class="btn btn-primary">匯出資料</button>
                <button id="importBtn" class="btn btn-secondary">匯入資料</button>
            </div>
            <input type="file" id="importFileInput" accept=".json" class="hidden">
        </div>
    </aside>

    <div class="container">
        <header class="header">
            <button id="sidebarToggle" class="btn btn-secondary sidebar-toggle-btn">建築管理</button>
            <h1>三國志城建優化器</h1>
        </header>

        <!-- 配置管理 -->
        <section class="section config-section">
            <div class="config-buttons">
                <button id="newConfigBtn" class="btn btn-secondary">重設</button>
                <button id="loadConfigBtn" class="btn btn-secondary">載入配置</button>
                <button id="saveConfigBtn" class="btn btn-primary">儲存配置</button>
            </div>
        </section>

        <!-- 槽位選擇 -->
        <section class="section">
            <h2 class="section-title">已開放槽位</h2>
            <div class="slots-grid">
                <label class="slot-label">
                    <input type="checkbox" id="slot-mainHall" class="slot-checkbox" checked>
                    <span>主殿</span>
                </label>
                <label class="slot-label">
                    <input type="checkbox" id="slot-cityWall" class="slot-checkbox" checked>
                    <span>城牆</span>
                </label>
                <label class="slot-label">
                    <input type="checkbox" id="slot-plaza" class="slot-checkbox" checked>
                    <span>廣場</span>
                </label>
                <label class="slot-label">
                    <input type="checkbox" id="slot-westMarket1" class="slot-checkbox" checked>
                    <span>西坊</span>
                </label>
                <label class="slot-label">
                    <input type="checkbox" id="slot-westMarket2" class="slot-checkbox" checked>
                    <span>西市</span>
                </label>
                <label class="slot-label">
                    <input type="checkbox" id="slot-eastMarket1" class="slot-checkbox">
                    <span>東坊</span>
                </label>
                <label class="slot-label">
                    <input type="checkbox" id="slot-eastMarket2" class="slot-checkbox">
                    <span>東市</span>
                </label>
            </div>
        </section>

        <!-- 目標數值 -->
        <section class="section">
            <h2 class="section-title">目標數值 <span class="threshold-hint">(門檻: 15/50/75/100)</span></h2>
            <div class="targets-grid">
                <div class="target-item">
                    <label for="target-agriculture">農業</label>
                    <input type="number" id="target-agriculture" class="target-input" min="0" placeholder="0">
                </div>
                <div class="target-item">
                    <label for="target-mining">礦業</label>
                    <input type="number" id="target-mining" class="target-input" min="0" placeholder="0">
                </div>
                <div class="target-item">
                    <label for="target-military">軍事</label>
                    <input type="number" id="target-military" class="target-input" min="0" placeholder="0">
                </div>
                <div class="target-item">
                    <label for="target-commerce">商業</label>
                    <input type="number" id="target-commerce" class="target-input" min="0" placeholder="0">
                </div>
            </div>
        </section>

        <!-- 搜尋按鈕 -->
        <section class="section search-section">
            <button id="searchBtn" class="btn btn-large btn-primary">搜尋最佳組合</button>
        </section>

        <!-- 搜尋結果 -->
        <section class="section results-section">
            <h2 class="section-title">搜尋結果 <span class="results-hint">Top 5</span></h2>
            <div id="results" class="results-container">
                <div class="no-results">
                    <p>點擊「搜尋最佳組合」開始</p>
                </div>
            </div>
        </section>
    </div>

    <!-- 載入配置 Modal -->
    <div id="loadConfigModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>載入配置</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div id="configList" class="config-list"></div>
        </div>
    </div>

    <!-- 輸入 Modal (取代 prompt) -->
    <div id="inputModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3 id="inputModalTitle">輸入</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="inputModalInput" class="modal-input" placeholder="">
            </div>
            <div class="modal-footer">
                <button id="inputModalCancel" class="btn btn-secondary">取消</button>
                <button id="inputModalConfirm" class="btn btn-primary">確定</button>
            </div>
        </div>
    </div>

    <!-- 提示 Modal (取代 alert) -->
    <div id="alertModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3 id="alertModalTitle">提示</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="alertModalMessage"></p>
            </div>
            <div class="modal-footer">
                <button id="alertModalConfirm" class="btn btn-primary">確定</button>
            </div>
        </div>
    </div>

    <!-- 確認 Modal (取代 confirm) -->
    <div id="confirmModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3 id="confirmModalTitle">確認</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmModalMessage"></p>
            </div>
            <div class="modal-footer">
                <button id="confirmModalCancel" class="btn btn-secondary">取消</button>
                <button id="confirmModalConfirm" class="btn btn-danger">確定</button>
            </div>
        </div>
    </div>

    <!-- 建築變體選擇 Modal -->
    <div id="buildingVariantModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>選擇建築變體</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="variantBuildingName" class="variant-building-name"></p>
                <div id="variantList" class="variant-list"></div>
            </div>
            <div class="modal-footer">
                <button id="variantCancelBtn" class="btn btn-secondary">取消</button>
                <button id="variantAddBtn" class="btn btn-primary">新增選取</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/csv-parser.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/traits.js"></script>
    <script src="js/solver.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
